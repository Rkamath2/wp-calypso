<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1560px" preserveAspectRatio="none" style="width:1974px;height:1560px;" version="1.1" viewBox="0 0 1974 1560" width="1974px" zoomAndPan="magnify"><defs><filter height="300%" id="f14vl3906ky6zi" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FACFD2" height="1545.9883" style="stroke: #A80036; stroke-width: 1.0;" width="172" x="44" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="79" y="16.5684">WordPress.com</text><rect fill="#F7DCC6" height="1545.9883" style="stroke: #A80036; stroke-width: 1.0;" width="141" x="309.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="353.5" y="16.5684">Calypso</text><rect fill="#F5E6B3" height="1545.9883" style="stroke: #A80036; stroke-width: 1.0;" width="90" x="462.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="482.5" y="16.5684">Actions</text><rect fill="#B8E6BF" height="1545.9883" style="stroke: #A80036; stroke-width: 1.0;" width="1385" x="570" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="1193.5" y="16.5684">Composite Checkout</text><rect fill="#FFFFFF" filter="url(#f14vl3906ky6zi)" height="114.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="125" y="792.4492"/><rect fill="#FFFFFF" filter="url(#f14vl3906ky6zi)" height="114.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="125" y="1331.9707"/><rect fill="#FFFFFF" filter="url(#f14vl3906ky6zi)" height="157.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="375" y="763.1387"/><rect fill="#FFFFFF" filter="url(#f14vl3906ky6zi)" height="157.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="375" y="1302.6602"/><rect fill="#FFFFFF" filter="url(#f14vl3906ky6zi)" height="311.6367" style="stroke: #000000; stroke-width: 2.0;" width="501" x="564" y="364.5703"/><rect fill="#FFFFFF" height="108.1973" style="stroke: none; stroke-width: 1.0;" width="501" x="564" y="459.8125"/><rect fill="#FFFFFF" height="108.1973" style="stroke: none; stroke-width: 1.0;" width="501" x="564" y="568.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="130" x2="130" y1="91.7754" y2="1478.5234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="379.5" x2="379.5" y1="91.7754" y2="1478.5234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="507.5" x2="507.5" y1="91.7754" y2="1478.5234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="657" x2="657" y1="91.7754" y2="1478.5234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="946" x2="946" y1="91.7754" y2="1478.5234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1168" x2="1168" y1="91.7754" y2="1478.5234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1391" x2="1391" y1="91.7754" y2="1478.5234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1611" x2="1611" y1="91.7754" y2="1478.5234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1837" x2="1837" y1="91.7754" y2="1478.5234"/><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="53" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="63.5" y="43.8457">WPCOM_JSON_API_</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="60" y="60.334">Me_Shopping_Cart_</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="97" y="76.8223">Endpoint</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="53" y="1477.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="63.5" y="1498.0586">WPCOM_JSON_API_</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="60" y="1514.5469">Me_Shopping_Cart_</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="97" y="1531.0352">Endpoint</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="318.5" y="56.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="325.5" y="76.8223">Undocumented</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="318.5" y="1477.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="325.5" y="1498.0586">Undocumented</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="466.5" y="88.8223">/checkout/</text><ellipse cx="507.5" cy="59.2871" fill="#FEFECE" filter="url(#f14vl3906ky6zi)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="503.5,47.2871,509.5,42.2871,507.5,47.2871,509.5,52.2871,503.5,47.2871" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="466.5" y="1491.0586">/checkout/</text><ellipse cx="507.5" cy="1510.0117" fill="#FEFECE" filter="url(#f14vl3906ky6zi)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="503.5,1498.0117,509.5,1493.0117,507.5,1498.0117,509.5,1503.0117,503.5,1498.0117" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="579" y="56.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="586" y="76.8223">CompositeCheckout</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="579" y="1477.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="586" y="1498.0586">CompositeCheckout</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="203" x="843" y="56.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="189" x="850" y="76.8223">usePrepareProductsForCart</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="203" x="843" y="1477.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="189" x="850" y="1498.0586">usePrepareProductsForCart</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="193" x="1070" y="56.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="1077" y="76.8223">useShoppingCartManager</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="193" x="1070" y="1477.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="1077" y="1498.0586">useShoppingCartManager</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="1287" y="56.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="190" x="1294" y="76.8223">useInitializeCartFromServer</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="1287" y="1477.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="190" x="1294" y="1498.0586">useInitializeCartFromServer</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="189" x="1515" y="56.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="175" x="1522" y="76.8223">useShoppingCartReducer</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="189" x="1515" y="1477.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="175" x="1522" y="1498.0586">useShoppingCartReducer</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="214" x="1728" y="56.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="200" x="1735" y="76.8223">useCartUpdateAndRevalidate</text><rect fill="#FEFECE" filter="url(#f14vl3906ky6zi)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="214" x="1728" y="1477.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="200" x="1735" y="1498.0586">useCartUpdateAndRevalidate</text><rect fill="#FFFFFF" filter="url(#f14vl3906ky6zi)" height="114.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="125" y="792.4492"/><rect fill="#FFFFFF" filter="url(#f14vl3906ky6zi)" height="114.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="125" y="1331.9707"/><rect fill="#FFFFFF" filter="url(#f14vl3906ky6zi)" height="157.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="375" y="763.1387"/><rect fill="#FFFFFF" filter="url(#f14vl3906ky6zi)" height="157.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="375" y="1302.6602"/><polygon fill="#A80036" points="645.5,119.0859,655.5,123.0859,645.5,127.0859,649.5,123.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="380" x2="651.5" y1="123.0859" y2="123.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="387" y="118.3438">import setCart</text><path d="M578,136.0859 L578,176.0859 L733,176.0859 L733,146.0859 L723,136.0859 L578,136.0859 " fill="#FBFB77" filter="url(#f14vl3906ky6zi)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M723,136.0859 L723,146.0859 L733,146.0859 L723,136.0859 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="584" y="153.6543">setCart from props</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="584" y="168.9648">or fall back to import</text><polygon fill="#A80036" points="1156.5,203.0176,1166.5,207.0176,1156.5,211.0176,1160.5,207.0176" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="657.5" x2="1162.5" y1="207.0176" y2="207.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="664.5" y="202.2754">setCart</text><polygon fill="#A80036" points="1825,232.3281,1835,236.3281,1825,240.3281,1829,236.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1168.5" x2="1831" y1="236.3281" y2="236.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="1175.5" y="231.5859">setCart</text><path d="M432,249.3281 L432,289.3281 L578,289.3281 L578,259.3281 L568,249.3281 L432,249.3281 " fill="#FBFB77" filter="url(#f14vl3906ky6zi)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M568,249.3281 L568,259.3281 L578,259.3281 L568,249.3281 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="438" y="266.8965">Extracts parameters</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="438" y="282.207">from URL path</text><polygon fill="#A80036" points="645.5,316.2598,655.5,320.2598,645.5,324.2598,649.5,320.2598" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="507.5" x2="651.5" y1="320.2598" y2="320.2598"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="514.5" y="315.5176">product, purchaseId</text><polygon fill="#A80036" points="934.5,345.5703,944.5,349.5703,934.5,353.5703,938.5,349.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="657.5" x2="940.5" y1="349.5703" y2="349.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="664.5" y="344.8281">product, purchaseId</text><path d="M564,364.5703 L626,364.5703 L626,371.5703 L616,381.5703 L564,381.5703 L564,364.5703 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="311.6367" style="stroke: #000000; stroke-width: 2.0;" width="501" x="564" y="364.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="579" y="378.1387">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="641" y="377.2051">[Plan]</text><polygon fill="#FBFB77" filter="url(#f14vl3906ky6zi)" points="883,386.8809,1009,386.8809,1019,405.8809,1009,424.8809,883,424.8809,873,405.8809,883,386.8809" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="885" y="403.4492">no purchaseId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="885" y="418.7598">product in getPlans</text><polygon fill="#A80036" points="668.5,447.8125,658.5,451.8125,668.5,455.8125,664.5,451.8125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="662.5" x2="945.5" y1="451.8125" y2="451.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="674.5" y="447.0703">&lt;&lt; createItemToAddToCart &gt;&gt;</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="564" x2="1065" y1="460.8125" y2="460.8125"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="569" y="471.4473">[Product]</text><polygon fill="#FBFB77" filter="url(#f14vl3906ky6zi)" points="861,479.7676,1032,479.7676,1042,505.7676,1032,532.7676,861,532.7676,851,505.7676,861,479.7676" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="863" y="496.3359">no purchaseId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="863" y="511.6465">product not in getPlans</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="863" y="526.957">product in getProductsList</text><polygon fill="#A80036" points="668.5,556.0098,658.5,560.0098,668.5,564.0098,664.5,560.0098" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="662.5" x2="945.5" y1="560.0098" y2="560.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="674.5" y="555.2676">&lt;&lt; createItemToAddToCart &gt;&gt;</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="564" x2="1065" y1="569.0098" y2="569.0098"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="569" y="579.6445">[Renewal]</text><polygon fill="#FBFB77" filter="url(#f14vl3906ky6zi)" points="861,587.9648,1032,587.9648,1042,606.9648,1032,625.9648,861,625.9648,851,606.9648,861,587.9648" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="863" y="604.5332">has purchaseId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="863" y="619.8438">product in getProductsList</text><polygon fill="#A80036" points="668.5,664.207,658.5,668.207,668.5,672.207,664.5,668.207" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="662.5" x2="945.5" y1="668.207" y2="668.207"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="674.5" y="648.1543">&lt;&lt; createRenewalItemToAddToCart &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="706.5" y="663.4648">&lt;&lt; getRenewalItemFromCartItem &gt;&gt;</text><polygon fill="#A80036" points="1156.5,700.5176,1166.5,704.5176,1156.5,708.5176,1160.5,704.5176" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="657.5" x2="1162.5" y1="704.5176" y2="704.5176"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="664.5" y="699.7754">productsToAddOnInitialize</text><polygon fill="#A80036" points="1379,729.8281,1389,733.8281,1379,737.8281,1383,733.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1168.5" x2="1385" y1="733.8281" y2="733.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="1175.5" y="729.0859">productsToAddOnInitialize</text><polygon fill="#A80036" points="396,759.1387,386,763.1387,396,767.1387,392,763.1387" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="390" x2="1390" y1="763.1387" y2="763.1387"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="402" y="758.3965">&lt;&lt; setCart &gt;&gt;</text><polygon fill="#A80036" points="146,788.4492,136,792.4492,146,796.4492,142,792.4492" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="140" x2="374" y1="792.4492" y2="792.4492"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="152" y="787.707">POST /me/shopping-cart/{cartKey}</text><path d="M8,805.4492 L8,891.4492 L248,891.4492 L248,815.4492 L238,805.4492 L8,805.4492 " fill="#FBFB77" filter="url(#f14vl3906ky6zi)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M238,805.4492 L238,815.4492 L248,815.4492 L238,805.4492 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="14" y="823.0176">getRenewalItemFromCartItem adds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="18" y="838.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="14" y="853.6387">{ extra: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="46" y="868.9492">purchaseType: 'renewal'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="14" y="884.2598">} }</text><polygon fill="#A80036" points="363,903.002,373,907.002,363,911.002,367,907.002" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="130" x2="369" y1="907.002" y2="907.002"/><polygon fill="#A80036" points="1379,917.002,1389,921.002,1379,925.002,1383,921.002" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="380" x2="1385" y1="921.002" y2="921.002"/><path d="M1271,934.002 L1271,974.002 L1506,974.002 L1506,944.002 L1496,934.002 L1271,934.002 " fill="#FBFB77" filter="url(#f14vl3906ky6zi)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1496,934.002 L1496,944.002 L1506,944.002 L1496,934.002 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="1277" y="951.5703">Dispatch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="1277" y="966.8809">RECEIVE_INITIAL_RESPONSE_CART</text><polygon fill="#A80036" points="518.5,1000.9336,508.5,1004.9336,518.5,1008.9336,514.5,1004.9336" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="512.5" x2="1167.5" y1="1004.9336" y2="1004.9336"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="524.5" y="1000.1914">addItem</text><path d="M362,1017.9336 L362,1088.9336 L648,1088.9336 L648,1027.9336 L638,1017.9336 L362,1017.9336 " fill="#FBFB77" filter="url(#f14vl3906ky6zi)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M638,1017.9336 L638,1027.9336 L648,1027.9336 L638,1017.9336 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="368" y="1035.502">&lt;&lt; getRenewableSitePurchases &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="368" y="1050.8125">sent to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="368" y="1066.123">&lt;&lt; getRenewalItemFromProduct &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="400" y="1081.4336">&lt;&lt; getRenewalItemFromCartItem &gt;&gt;</text><polygon fill="#A80036" points="1599.5,1146.1074,1609.5,1150.1074,1599.5,1154.1074,1603.5,1150.1074" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="507.5" x2="1605.5" y1="1150.1074" y2="1150.1074"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="514.5" y="1114.7441">&lt;&lt; addItem &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="514.5" y="1130.0547">dispatches</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="514.5" y="1145.3652">ADD_CART_ITEM</text><path d="M1533,1163.1074 L1533,1188.1074 L1685,1188.1074 L1685,1173.1074 L1675,1163.1074 L1533,1163.1074 " fill="#FBFB77" filter="url(#f14vl3906ky6zi)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1675,1163.1074 L1675,1173.1074 L1685,1173.1074 L1675,1163.1074 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="1539" y="1180.6758">cacheStatus: 'invalid'</text><polygon fill="#A80036" points="1825,1214.7285,1835,1218.7285,1825,1222.7285,1829,1218.7285" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1611.5" x2="1831" y1="1218.7285" y2="1218.7285"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="1618.5" y="1213.9863">cacheStatus</text><path d="M1707,1231.7285 L1707,1271.7285 L1962,1271.7285 L1962,1241.7285 L1952,1231.7285 L1707,1231.7285 " fill="#FBFB77" filter="url(#f14vl3906ky6zi)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1952,1231.7285 L1952,1241.7285 L1962,1241.7285 L1952,1231.7285 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="1713" y="1249.2969">Dispatch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="1713" y="1264.6074">REQUEST_UPDATED_RESPONSE_CART</text><polygon fill="#A80036" points="396,1298.6602,386,1302.6602,396,1306.6602,392,1302.6602" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="390" x2="1836" y1="1302.6602" y2="1302.6602"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="402" y="1297.918">&lt;&lt; setCart &gt;&gt;</text><polygon fill="#A80036" points="146,1327.9707,136,1331.9707,146,1335.9707,142,1331.9707" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="140" x2="374" y1="1331.9707" y2="1331.9707"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="152" y="1327.2285">POST /me/shopping-cart/{cartKey}</text><path d="M8,1344.9707 L8,1430.9707 L248,1430.9707 L248,1354.9707 L238,1344.9707 L8,1344.9707 " fill="#FBFB77" filter="url(#f14vl3906ky6zi)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M238,1344.9707 L238,1354.9707 L248,1354.9707 L238,1344.9707 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="14" y="1362.5391">getRenewalItemFromCartItem adds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="18" y="1377.8496"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="14" y="1393.1602">{ extra: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="46" y="1408.4707">purchaseType: 'renewal'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="14" y="1423.7813">} }</text><polygon fill="#A80036" points="363,1442.5234,373,1446.5234,363,1450.5234,367,1446.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="130" x2="369" y1="1446.5234" y2="1446.5234"/><polygon fill="#A80036" points="1825,1456.5234,1835,1460.5234,1825,1464.5234,1829,1460.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="380" x2="1831" y1="1460.5234" y2="1460.5234"/><!--
@startuml


skinparam ParticipantPadding 5
skinparam BoxPadding 5
box "WordPress.com" #facfd2
  participant WPCOM_JSON_API_Me_Shopping_Cart_Endpoint as "WPCOM_JSON_API_\nMe_Shopping_Cart_\nEndpoint"
end box
box "Calypso" #f7dcc6
  participant Undocumented
end box
box "Actions" #f5e6b3
	control CheckoutController as "/checkout/"
end box
box "Composite Checkout" #b8e6bf
  participant CompositeCheckout
  participant usePrepareProductsForCart
  participant useShoppingCartManager
  participant useInitializeCartFromServer
  participant useShoppingCartReducer
  participant useCartUpdateAndRevalidate
end box

Undocumented -> CompositeCheckout : import setCart
note over CompositeCheckout
	setCart from props
	or fall back to import
end note
CompositeCheckout -> useShoppingCartManager : setCart
useShoppingCartManager -> useCartUpdateAndRevalidate : setCart

note over CheckoutController
	Extracts parameters
	from URL path
end note
CheckoutController -> CompositeCheckout : product, purchaseId
CompositeCheckout -> usePrepareProductsForCart : product, purchaseId
alt Plan
	hnote over usePrepareProductsForCart
		no purchaseId
		product in getPlans
	end hnote
	usePrepareProductsForCart -> CompositeCheckout : << createItemToAddToCart >>
else Product
	hnote over usePrepareProductsForCart
		no purchaseId
		product not in getPlans
		product in getProductsList
	end hnote
	usePrepareProductsForCart -> CompositeCheckout : << createItemToAddToCart >>
else Renewal
	hnote over usePrepareProductsForCart
		has purchaseId
		product in getProductsList
	end hnote
	usePrepareProductsForCart -> CompositeCheckout : << createRenewalItemToAddToCart >>\n\t<< getRenewalItemFromCartItem >>
end
CompositeCheckout -> useShoppingCartManager : productsToAddOnInitialize
useShoppingCartManager -> useInitializeCartFromServer : productsToAddOnInitialize
useInitializeCartFromServer -> Undocumented : << setCart >>
activate Undocumented
Undocumented -> WPCOM_JSON_API_Me_Shopping_Cart_Endpoint : POST /me/shopping-cart/{cartKey}
activate WPCOM_JSON_API_Me_Shopping_Cart_Endpoint
note over WPCOM_JSON_API_Me_Shopping_Cart_Endpoint
	getRenewalItemFromCartItem adds

	{ extra: {
		purchaseType: 'renewal'
	} }
end note
return
return
note over useInitializeCartFromServer
	Dispatch
	RECEIVE_INITIAL_RESPONSE_CART
end note

useShoppingCartManager -> CheckoutController : addItem
note over CheckoutController
	<< getRenewableSitePurchases >>
	sent to
	<< getRenewalItemFromProduct >>
		<< getRenewalItemFromCartItem >>
end note

CheckoutController -> useShoppingCartReducer : << addItem >>\ndispatches\nADD_CART_ITEM
note over useShoppingCartReducer
	cacheStatus: 'invalid'
end note
useShoppingCartReducer -> useCartUpdateAndRevalidate : cacheStatus
note over useCartUpdateAndRevalidate
	Dispatch
	REQUEST_UPDATED_RESPONSE_CART
end note
useCartUpdateAndRevalidate -> Undocumented : << setCart >>
activate Undocumented
Undocumented -> WPCOM_JSON_API_Me_Shopping_Cart_Endpoint : POST /me/shopping-cart/{cartKey}
activate WPCOM_JSON_API_Me_Shopping_Cart_Endpoint
note over WPCOM_JSON_API_Me_Shopping_Cart_Endpoint
	getRenewalItemFromCartItem adds

	{ extra: {
		purchaseType: 'renewal'
	} }
end note
return
return

@enduml

PlantUML version 1.2019.06(Fri May 24 12:10:25 CDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 14+36-1461
Operating System: Mac OS X
OS Version: 10.15.6
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>